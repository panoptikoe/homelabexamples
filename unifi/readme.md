Yes, this is messy. It works though.
